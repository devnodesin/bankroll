services:
  bankroll:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: bankroll
    restart: unless-stopped
    ports:
      - "8000:80"
      - "8443:443"
    volumes:
      # Mount SQLite database file
      - ./data/database.sqlite:/bankroll/data/database.sqlite
      # Mount logs directory
      - ./data/logs:/bankroll/storage/logs
    environment:
      # Application Environment
      APP_ENV: "production"
      # Currency Configuration
      CURRENCY_SYMBOL: "â‚¹"
      # Generate with: php artisan key:generate --show
      APP_KEY: base64:zRuC51slKq8yusnJx3iZ7LDh0NijEf7x1sxITkQ0Fe4=
      APP_DEBUG: "false"
      APP_URL: "http://localhost:8000"
      
      # Database Configuration
      DB_CONNECTION: "sqlite"
      DB_DATABASE: "/bankroll/data/database.sqlite"
      
      # FrankenPHP Configuration
      SERVER_NAME: ":80, :443"
      FRANKENPHP_CONFIG: "worker /bankroll/public/index.php"
      

    healthcheck:
      test: ["CMD", "php", "-r", "exit(0);"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 40s
