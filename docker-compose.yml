services:
  bankroll:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: bankroll
    restart: unless-stopped
    ports:
      - "8000:80"
      - "8443:443"
    volumes:
      # Mount SQLite database file
      - ./data/database.sqlite:/var/www/html/database/database.sqlite
      # Mount logs directory
      - ./data/logs:/var/www/html/storage/logs
    environment:
      # Application Environment
      APP_NAME: "Bankroll"
      APP_ENV: "production"
      APP_KEY: "base64:YOUR_APP_KEY_HERE"  # Generate with: php artisan key:generate --show
      APP_DEBUG: "false"
      APP_URL: "http://localhost:8000"
      
      # Currency Configuration
      CURRENCY_SYMBOL: "â‚¹"
      
      # Application Settings
      APP_LOCALE: "en"
      APP_FALLBACK_LOCALE: "en"
      APP_FAKER_LOCALE: "en_US"
      
      # Logging
      LOG_CHANNEL: "stack"
      LOG_STACK: "single"
      LOG_LEVEL: "error"
      
      # Database Configuration (SQLite)
      DB_CONNECTION: "sqlite"
      DB_DATABASE: "/var/www/html/database/database.sqlite"
      
      # Session Configuration
      SESSION_DRIVER: "database"
      SESSION_LIFETIME: "120"
      SESSION_ENCRYPT: "false"
      SESSION_PATH: "/"
      SESSION_DOMAIN: "null"
      
      # Cache Configuration
      CACHE_STORE: "database"
      
      # Queue Configuration
      QUEUE_CONNECTION: "database"
      
      # Other Configurations
      BROADCAST_CONNECTION: "log"
      FILESYSTEM_DISK: "local"
      
      # Mail Configuration
      MAIL_MAILER: "log"
      MAIL_FROM_ADDRESS: "hello@example.com"
      MAIL_FROM_NAME: "Bankroll"
    healthcheck:
      test: ["CMD", "php", "-r", "exit(0);"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 40s
